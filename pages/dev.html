<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dev Projects - EOSYN.NET</title>
    <link rel="stylesheet" href="../styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        .dev-container {
            padding: 1rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .dev-header {
            padding: 0.5rem 0;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 1rem;
        }

        .dev-header h1 {
            color: var(--text-primary);
            font-size: 1.5rem;
            display: inline;
            margin-right: 0.75rem;
        }

        .dev-header p {
            color: var(--text-secondary);
            font-size: 0.95rem;
            display: inline;
        }

        .dev-sections {
            display: grid;
            gap: 2rem;
            margin-top: 2rem;
        }

        .dev-section {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 1.5rem;
        }

        .dev-section h2 {
            color: var(--accent-primary);
            font-size: 1.3rem;
            margin-bottom: 0.5rem;
        }

        .dev-section-description {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-bottom: 1rem;
        }

        .articles-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1.5rem;
            margin-top: 1rem;
        }

        @media (max-width: 1024px) {
            .articles-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 640px) {
            .articles-grid {
                grid-template-columns: 1fr;
            }
        }

        .article-card {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            padding: 1rem;
            transition: all 0.3s ease;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .article-card:hover {
            border-color: var(--accent-primary);
            transform: translateY(-3px);
            box-shadow: 0 4px 12px rgba(189, 147, 249, 0.2);
        }

        .article-title {
            color: var(--text-primary);
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .article-excerpt {
            color: var(--text-secondary);
            font-size: 0.85rem;
            line-height: 1.4;
            margin-bottom: 0.5rem;
            flex: 1;
        }

        .article-date {
            color: var(--text-tertiary);
            font-size: 0.8rem;
            margin-top: auto;
            padding-top: 0.5rem;
            border-top: 1px solid var(--border-color);
        }

        .empty-message {
            color: var(--text-secondary);
            font-style: italic;
            padding: 2rem;
            text-align: center;
        }

        /* Article view styles */
        .article-view {
            display: grid;
            grid-template-columns: 1fr 250px;
            gap: 2rem;
            position: relative;
        }

        .back-btn {
            position: absolute;
            top: -2rem;
            left: 0;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            padding: 0.5rem 1rem;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .back-btn:hover {
            background: var(--bg-tertiary);
            border-color: var(--accent-primary);
        }

        .article-content {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 2rem;
            grid-column: 1;
        }

        .article-content h1 {
            color: var(--text-primary);
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--border-color);
        }

        .article-body {
            color: var(--text-secondary);
            line-height: 1.6;
        }

        .article-body h2,
        .article-body h3,
        .article-body h4 {
            color: var(--text-primary);
            margin-top: 1.5rem;
            margin-bottom: 0.75rem;
        }

        .article-body code {
            background: var(--bg-tertiary);
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
        }

        .article-body pre {
            background: var(--bg-tertiary);
            padding: 1rem;
            border-radius: 6px;
            overflow-x: auto;
            margin: 1rem 0;
        }

        .article-toc {
            position: sticky;
            top: 1rem;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 1rem;
            max-height: calc(100vh - 200px);
            overflow-y: auto;
        }

        .article-toc h3 {
            color: var(--accent-primary);
            font-size: 0.9rem;
            margin-bottom: 1rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        #toc-nav {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .toc-link {
            color: var(--text-secondary);
            text-decoration: none;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            transition: all 0.2s ease;
            font-size: 0.85rem;
        }

        .toc-h2 {
            padding-left: 0.5rem;
        }

        .toc-h3 {
            padding-left: 1.5rem;
            font-size: 0.8rem;
        }

        .toc-h4 {
            padding-left: 2.5rem;
            font-size: 0.75rem;
        }

        .toc-link:hover {
            background: var(--bg-tertiary);
            color: var(--accent-primary);
        }

        .no-toc {
            color: var(--text-tertiary);
            font-style: italic;
            font-size: 0.85rem;
        }

        @media (max-width: 1024px) {
            .article-view {
                grid-template-columns: 1fr;
            }

            .article-toc {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="site-header-wrapper" id="siteHeader">
        <header class="header">
            <div class="header-content">
                <img src="../assets/images/eosynnet.png" alt="EOSYN.NET" class="site-logo">
            </div>
        </header>

        <nav class="navigation">
            <div class="nav-container">
                <button class="nav-toggle" id="navToggle">☰</button>
                <ul class="nav-menu" id="navMenu">
                    <li><a href="../index.html#home" class="nav-link">Home</a></li>

                </ul>
                <div class="nav-actions">
                    <div class="search-container">
                        <input type="text" id="search-input" class="search-input" placeholder="Search articles...">
                    </div>
                    <select id="theme-select" class="theme-select-nav" onchange="applyTheme(this.value)" title="Theme">
                        <option value="dracula">Dracula</option>
                        <option value="light">Light</option>
                        <option value="nord">Nord</option>
                        <option value="monokai">Monokai</option>
                        <option value="alice">Alice</option>
                        <option value="gruvbox">Gruvbox Dark</option>
                        <option value="catppuccin">Catppuccin Mocha</option>
                        <option value="synthwave">Synthwave</option>
                    </select>
                    <button class="nav-action-btn" onclick="showFavorites()" title="My Favorites">
                        <span></span>
                    </button>
                    <button class="nav-action-btn" onclick="toggleUnifiedPanel('favorites')" title="Notes">
                        <span class="nav-action-label">☆ Notes</span>
                    </button>
                </div>
            </div>
        </nav>

        <div class="ticker-container">
            <div class="ticker-content" id="ticker-content">
                <span class="ticker-item">Loading ticker...</span>
            </div>
        </div>
    </div>

    <main class="content-wrapper">
        <div class="dev-container">
            <div class="dev-header">
                <h1>Dev:</h1>
                <p>projects, code, and technical writing</p>
            </div>

            <div class="dev-sections" id="devSections">
                <!-- Content will be loaded here -->
            </div>
        </div>
    </main>

    <script src="../assets/js/core/themes.js"></script>
    <script src="../assets/js/utils/unified-panel.js"></script>
    <script src="../assets/js/core/alice-background.js"></script>

    <!-- Required for markdown parsing and syntax highlighting -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/4.3.0/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">

    <script>
        // Populate navigation menu
        function loadNavigation() {
            const navMenu = document.getElementById('navMenu');
            if (!navMenu) return;

            // Clear existing items except Home
            while (navMenu.children.length > 1) {
                navMenu.removeChild(navMenu.lastChild);
            }

            // Add navigation items
            const navItems = [
                { text: 'Art', href: 'art.html' },
                { text: 'Dev', href: 'dev.html', active: true },
                { text: 'Games', href: 'games.html' },
                { text: 'Shop', href: 'shop.html' },
                { text: 'IRC', href: 'irc.html' },
                { text: 'Archive', href: '../index.html#archive' }
            ];

            navItems.forEach(item => {
                const li = document.createElement('li');
                const a = document.createElement('a');
                a.href = item.href;
                a.className = item.active ? 'nav-link active' : 'nav-link';
                a.textContent = item.text;
                li.appendChild(a);
                navMenu.appendChild(li);
            });

            // Add Media dropdown
            const mediaItem = document.createElement('li');
            mediaItem.className = 'nav-item-dropdown';
            mediaItem.innerHTML = `
                <a href="media.html" class="nav-link">Media ▼</a>
                <ul class="nav-dropdown">
                    <li><a href="music.html" class="nav-dropdown-link">Music</a></li>
                    <li><a href="watchlist.html" class="nav-dropdown-link">Watchlist</a></li>
                    <li><a href="nature.html" class="nav-dropdown-link">Nature</a></li>
                    <li><a href="situation.html" class="nav-dropdown-link">Situation</a></li>
                </ul>
            `;
            navMenu.appendChild(mediaItem);
        }

        // Load development content
        async function loadDevContent() {
            try {
                const response = await fetch('../data/manifest.json');
                const manifest = await response.json();

                const devSections = document.getElementById('devSections');
                const sections = ['projects', 'learning', 'resources'];

                sections.forEach(sectionName => {
                    const pages = manifest.pages.filter(page =>
                        page.section.toLowerCase() === sectionName
                    );

                    if (pages.length > 0) {
                        const sectionDiv = document.createElement('div');
                        sectionDiv.className = 'dev-section';

                        let sectionTitle = sectionName.charAt(0).toUpperCase() + sectionName.slice(1);
                        let description = '';

                        switch(sectionName) {
                            case 'projects':
                                description = 'My creative and technical projects';
                                break;
                            case 'learning':
                                description = 'Notes and resources from my learning journey';
                                break;
                            case 'resources':
                                description = 'Useful tools, links, and references';
                                break;
                        }

                        sectionDiv.innerHTML = `
                            <h2>${sectionTitle}</h2>
                            <div class="dev-section-description">${description}</div>
                            <div class="articles-grid">
                                ${pages.map(page => `
                                    <div class="article-card" data-section="${page.section}" data-filename="${page.filename}" onclick="loadArticle('${page.section}', '${page.filename}', '${page.title.replace(/'/g, "\\'")}')">
                                        <div class="article-title">${page.title}</div>
                                        <div class="article-excerpt">${page.excerpt}</div>
                                        <div class="article-date">${new Date(page.date).toLocaleDateString('en-US', {
                                            year: 'numeric',
                                            month: 'short',
                                            day: 'numeric'
                                        })}</div>
                                    </div>
                                `).join('')}
                            </div>
                        `;

                        devSections.appendChild(sectionDiv);
                    }
                });

                if (devSections.children.length === 0) {
                    devSections.innerHTML = `
                        <div class="empty-message">
                            No development content yet. Add markdown files to content/projects, content/learning, or content/resources folders.
                        </div>
                    `;
                }

            } catch (error) {
                console.error('Error loading dev content:', error);
                document.getElementById('devSections').innerHTML = `
                    <div class="empty-message">
                        Error loading content. Please try again later.
                    </div>
                `;
            }
        }

        // Function to dynamically load article content
        async function loadArticle(section, filename, title) {
            try {
                // Fetch the markdown file
                const response = await fetch(`../content/${section}/${filename}`);
                if (!response.ok) throw new Error('Article not found');

                const content = await response.text();

                // Parse frontmatter and content
                const frontmatterRegex = /^---\s*\n([\s\S]*?)\n---\s*\n/;
                const match = content.match(frontmatterRegex);
                let bodyContent = content;

                if (match) {
                    bodyContent = content.substring(match[0].length);
                }

                // Create article view
                const devContainer = document.querySelector('.dev-container');
                devContainer.innerHTML = `
                    <div class="article-view">
                        <button onclick="backToDevList()" class="back-btn">← Back to Dev</button>
                        <article class="article-content">
                            <h1>${title}</h1>
                            <div class="article-body markdown-content">
                                ${marked.parse(bodyContent)}
                            </div>
                        </article>
                        <aside class="article-toc">
                            <h3>Table of Contents</h3>
                            <nav id="toc-nav"></nav>
                        </aside>
                    </div>
                `;

                // Generate table of contents
                generateTOC();

                // Apply syntax highlighting
                if (typeof Prism !== 'undefined') {
                    Prism.highlightAll();
                }

            } catch (error) {
                console.error('Error loading article:', error);
                alert('Failed to load article. Please try again.');
            }
        }

        // Function to generate table of contents
        function generateTOC() {
            const headers = document.querySelectorAll('.article-body h2, .article-body h3, .article-body h4');
            const tocNav = document.getElementById('toc-nav');

            if (headers.length === 0) {
                tocNav.innerHTML = '<p class="no-toc">No sections available</p>';
                return;
            }

            const tocHTML = Array.from(headers).map(header => {
                const level = header.tagName.toLowerCase();
                const text = header.textContent;
                const id = text.toLowerCase().replace(/[^\w\s-]/g, '').replace(/\s+/g, '-');

                // Add ID to header for navigation
                header.id = id;

                return `<a href="#${id}" class="toc-link toc-${level}" onclick="scrollToSection('${id}'); return false;">${text}</a>`;
            }).join('');

            tocNav.innerHTML = tocHTML;
        }

        // Function to scroll to section
        function scrollToSection(id) {
            const element = document.getElementById(id);
            if (element) {
                element.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }

        // Function to go back to dev list
        function backToDevList() {
            loadDevContent();
        }

        // Make functions globally available
        window.loadArticle = loadArticle;
        window.backToDevList = backToDevList;
        window.scrollToSection = scrollToSection;

        // Initialize
        loadNavigation();
        loadDevContent();

        // Initialize theme
        initializeTheme();
    </script>
    <script src="../assets/js/utils/ticker.js"></script>
</body>
</html>